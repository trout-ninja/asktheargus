The Three Shared Facilities (System V IPC)

1. Shared Memory — The Communal Workbench

In the center of the courtyard is a large communal workbench.

- Multiple houses can come to the bench at the same time.
- Anything placed on the bench is instantly visible to others.
- The bench itself does not enforce order or safety—people must coordinate among themselves.

This is shared memory.

Mapping:
- The bench = shared memory segment
- The size of the bench = shmmax
- How many benches exist = shmmni
- How many people are currently using it = nattch

Important insight:
The bench remains in the courtyard even if everyone leaves, until the city explicitly removes it.

This is why shared memory segments can persist after processes exit.

--------------------------------------------------

2. Semaphores — The Gatekeeper with Tokens

Next to the workbench stands a gatekeeper holding a set of tokens.

- To use the workbench safely, a person must take a token.
- If no tokens are available, they must wait.
- When finished, they return the token.

This is a semaphore.

Mapping:
- The gatekeeper = semaphore set
- Number of tokens = semaphore value(s)
- Taking/returning a token = semop

Key point:
Semaphores do not do work themselves; they regulate behavior.

They exist solely to coordinate access to shared resources.

--------------------------------------------------

3. Message Queues — The City Bulletin Board

Along the courtyard wall is a bulletin board.

- Houses can pin notes onto it.
- Other houses can read the notes later.
- Notes are read in order and can be filtered by type.

This is a message queue.

Mapping:
- Bulletin board = message queue
- Notes = messages
- Board capacity = msgmnb
- Size of a note = msgmax

Unlike shared memory:
Communication here is structured, ordered, and buffered.
